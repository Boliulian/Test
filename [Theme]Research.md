





[TOC]



### 模式识别调研

#### 1.背景

##### 1.1术中微电极记录MER

简介：术中微电极记录（MER）是DBS手术过程中，定位刺激靶点时依赖的一种辅助记录手段（通常还伴随其他模态检测方法，如神经影像、立体定向地图坐标等），对于帕金森疾病即确定STN的位置。实现方式为在脑组织中插入一个直径小于100微米的微电极，在向神经目标前进的同时，将电极尖端的信号转导到音频，能够提供术中实时的检测信号，由专业医师在手术室中直接进行主观评估。

目的：DBS手术中精准定位刺激靶点，确认STN结构边界

优点：实时检测STN及周围组织功能边界；弥补神经影像分辨率限制；补偿结构误差

##### 1.2 MER信号分析现状

主观判断：术中由神经外科或神经生理医师进行，依靠经验辨认电极经过STN时特征的放电模式；

缺点：依赖专业能力，可能导致分析不一致；只能在单个时域内感知信号；解剖结构间断增加错误标记风险；复杂信号模式和噪声干扰增加数据解读难度

##### 1.3 问题提出

MER信号分析希望攻克问题：DBS手术过程中，基于MER实时信号，实现自动化定位刺激靶点（主要是识别STN上下边界）

优点：减少对人员专业性和经验的依赖，增加分析一致性；减少手术时间，降低病人负担

为了实现MER信号的自动化分析，可能有两种思路：1）特征分析，2）模式识别

特征分析的本质是信号处理，即提取MER信号的量化的、统计性的特征。Antonio Pesenti等人记录了功率谱密度算法在STN检测中的效用{pesenti*2004}；Falkenberg等人研究还表明，基于多种算法和多种特征的STN检测比单一方法敏感{falkenberg2006}；随后Chaovalitwongse小组研究了几种定量测度或特征检测STN的能力，并集成多个度量，以获得跨度量的潜在独立信息{wong2009}。然而，STN检测的敏感性在不同的试验患者中有所不同。这与医学文献一致，表明对一种手术有效的MER数据的统计特征可能对另一种手术无效。这种基于信号统计特性开发的自动化工具是一种patient-specific的无监督学习方法{chaovalitwongse2011}。

模式识别希望利用先验手术案例，从回顾性的数据集中识别出针对问题本身的关键“模式”，不局限于单一病人。该方法可能会在生理定位中提供额外的准确性，可能消除目标位置定性评估的主观偏差{chaovalitwongse2011}。

#### 2.方法

##### 2.1 模式识别实现方法：机器学习

机器学习分为有监督学习和无监督学习。有监督学习算法从“标记”的训练数据中学习，并生成一个模型，该模型可以对未知的数据进行预测。在无监督学习技术中，只有未标记的数据可用，然后算法会自动寻找相似的点和模式。

常见分类器包括：贝叶斯分类器；决策树和随机森林；k-Nearest Neighbour (kNN)；支持向量机（SVM）；Logistic regression；隐马尔可夫模型（HMM）

##### 2.2 机器学习方法的技术要点（细节，不重要）

①信号预处理

选择合适的信号长度，以减小噪声影响。建议MER电极稳定后的记录长度大于4s。

去除噪声和伪迹，同时利用算法识别分析所需的神经振荡。

②特征标准化

数据记录时，不同的记录特征组成了一个多维的特性集，而可比较的同质数据集，特别是背景神经属性，通常是特征提取、选择和分类等后续分析阶段的先决条件。患者特有的标准化通常只有在数据收集后才能确定，如果标准化参数尚未稳定，则可能会出现较差的准确性。

③特征提取和特征选择

需要去除不相关或冗余的特征，以提高分类精度和计算效率，同时降低分类器训练所需的训练实例数量。添加特征对提高性能的效果有限，部分特征可能对分类有负面影响。

#### 3.现有刺激靶点定位的模式识别研究综述

不同研究的分类法：a）数据记录特性，b）特征选择方式，c）使用的机器学习方法，d）目标靶点

wan2019中，共综述了2006年以来10篇使用机器学习方法对MER数据分类的文献，其中9篇为有监督学习，1篇为无监督学习；有两项研究报告了online测试结果；大部分研究的目标是识别STN上下界（或其一），有一项的目标包含Zona Incerta，两项的目标包含Substantia nigria

##### 3.1 基于Spike-dependent特征

常用特征包括：Modified burst index (MBI)；Pause index (PI) and Pause ratio (PR)；Compound firing rate (CFS)；Mean spike amplitude differential；Standard deviation of interspike intervals (ISI rms)；Mean spike trigger frequency；Spike fraction

spike-dependent参数对数据质量和峰检测算法要求高，对误差敏感。因此近期倾向于使用spike-independent特征。

##### 3.2 基于Spike-independent特征

常用Spike-independent特征包括：Estimated distance to target (EDT)；Basal amplitude；Signal kurtosis；Curve length (CL)；Threshold；Peaks；Average nonlinear energy (ANE)；Zero crossings；Teager energy；Normalized root mean square (NRMS)；Noise mode；Power spectral density (PSD)

以下3项工作存在关联

Moran2006使用贝叶斯方法，基于Estimated distance to target (EDT)和Normalized root mean square (NRMS)特征参数，可以预测STN的上界，但是STN的下界在某些轨迹中预测得不好；

Zaidel2009在Moran2006基础上，增加了beta power spectral density (PSD)特征，使用隐马尔可夫模型方法，区分STN的准确度比贝叶斯方法更高，且能够区分STN的感觉运动subterritory；

Valsky2017在Zaidel2009基础上，限制功率比在100–150/5–25 Hz，使用隐马尔可夫模型方法，提高了STN下界的检测准确度。

△Novak2011提出了基于频域计算的multiunit activity (MUA)方法。MUA是记录电极附近的峰值活性的集合，Novak2011发现MUA在STN较周围其它区域升高。取得了MUA检测和术中检测良好的相关性。

##### 3.3 基于Spike-dependent，Spike-independent，和背景神经活动结合

背景活动特征包括：background curve length, RMS, amplitude and signal power

以下工作较为独立

△Danish2008，通过目测RMS特征，Danish等人(2008)报告了使用0.5 mm精度标准的灵敏度为90%，使用0.5 mm精度标准分别识别STN上下界的灵敏度为80%。使用background curve length灵敏度下降。

Cagnan2011基于background neural activity, firing rate and PSD of low band index (3–12 Hz), beta band index (13–30 Hz) and gamma band index (31–100 Hz)特征，得到的分类器（没有说明类型）与外科标注达到88%的一致性。

Ciecierski2014基于a combination of spike dependent features (spike frequency and modified burst ratio) and background neural attributes (absolute amplitude value, RMS, low frequency power in 0–500 Hz and high frequency in 500–3000 Hz)特征，使用决策树方法，获得了97.6%和96.7%的STN检测准确度。该算法的计算时间为两分钟。

Chaovalitwongse2011基于7个spike detection-dependent和6个spike detection-independent特征，使用多种机器学习建模方法，准确率接近90%。与贝叶斯模型(84.8%)和KNN模型(82.3%)相比，使用Gini和Max Deviance indices时，决策树的准确率分别为87.6%和89.6%。

Schiaffino2016表明他们的模糊KNN检测算法明显优于KNN算法 (p < 0.01)。

发展角度：使用local field potentials，使用burst firing patterns定位subterritories，使用隐马尔可夫模型模型改进自动化精度和计算时间；有前途的半自动化技术，如HaGuide工具，已获得FDA批准，目前正在多个小组中进行验证{Thompson2018}；目前还没有关于GPi核自动定位的研究



EEG-fMRI融合方法

脑电图(EEG)和功能磁共振成像(fMRI)是两种无创的神经成像方式，广泛应用于神经科学研究{lopesdasilva2013}。两种模态在空间和时间分辨率上互相补充，并由此诞生了EEG-fMRI同时测量的实验手段。早期，由于模态间存在的电磁干扰，该技术一直未得到广泛应用，近期随着技术手段的突破，获取的数据质量大幅提高，主要矛盾转化为缺乏有效和规范性的方法对数据进行融合分析{philiastides2021}。

从同时采集的EEG-fMRI数据中可以发现互补的时空信息，来研究与大脑行为功能有关的神经活动，以弥补单一模态的时间或空间分辨率不足。使用这些方法的研究表明，融合产生了对大脑功能的新见解，而这些发现从单一模态中无法获取{philiastides2021}。

EEG-fMRI多模态数据融合可分为**对称和非对称两种方法**。如果一个模态被当作一个先验或约束来指导另一个模态的分析，则称融合是不对称的。或者，如果以平等的方式使用来自每个模态的信息，则融合是对称的。对称融合可以进一步分为两类：模型驱动和数据驱动。在模型驱动方法中，EEG和fMRI通过共同的神经基质明确地建模神经血管耦合，在生成框架中集成。另一方面，数据驱动方法避免了EEG和fMRI生成过程的复杂建模。相反，他们使用一些计算机制直接利用EEG和fMRI在特征空间中的协方差，而不考虑它们潜在的生物物理属性可能存在的差异{philiastides2021}。

**EEG辅助fMRI分析**是使用最广泛的模态融合方法。不同形式的EEG特征可以通过单变量或多变量的方法提取，这取决于所关注的问题和关于EEG-fMRI关系的潜在假设。EEG特征(如ERP振幅、功率谱和seizures)被用来预测fMRI的BOLD变化。 Liu等人提出了一种用于EEG-fMRI融合的一般线性模型(GLM)模型。融合结果表明，顶叶内沟和额叶执行区是任务相关视觉皮层偏误的主要来源，而任务无关默认网络和感觉运动皮层在视觉注意过程中受到抑制{liu2014}。 **EEG辅助fMRI分析的一个潜在的重要优势是，它可以揭示更深/皮层下结构的激活，提供其BOLD活动与EEG皮质源信号多试验变异的共变规律，而这些结构由于尺寸较小、信噪比较低经常被忽略**{philiastides2021}。EEG辅助fMRI分析还可以用于**动态网络重建**，描述有时间先后顺序的两个系统内以及两个系统之间的节点交互{muraskin2018}。

数据驱动的非对称方法依赖机器学习算法，利用EEG和fMRI的特征空间训练分类器。一种方法是在单个模态的空间训练分类器，但模态间通过成本函数联系，促进反复试验可变性的相似性。

尽管分析EEG-fMRI数据的方法得到了广泛的发展，但该方法面临两个具有挑战性的问题：一是如何处理EEG与fMRI之间的相互干扰，二是如何处理EEG-fMRI数据的非线性{yang2018}。

STN功能研究

{baudrexel2011} 进行了PD患者静息态fMRI分析，发现STN与运动皮质间呈现异常增加的连接模式，且FC的增加主要出现在基底神经节内的STN区，该区域FC变化与震颤有关。该结果可能与PD中广泛观测到的STN-M1异常beta同步增加有关。

{frank2015} 利用同时测量的EEG和fMRI信号和决策模型，揭示了STN在人类强化学习中的功能特点：STN神经活动会动态地调整不同试验中的决策阈值，并进一步受决策冲突（trial-by-trial measure of decision ocnflict）和背内侧额叶皮层活动调节（表征为pre-SMABOLD and mediofrontal theta in EEG）。这些发现为一个模型提供了汇聚的多模态证据，即在基于奖励的任务中，当选择造成的奖励值存在细微差异时，决策阈值会随着pre-SMA和STN之间的交流而调整，从而允许更多的时间来选择统计上奖励更多的选项。

{zang2022} 利用PET/fMRI融合数据分析方法，分析了PD患者的STN与皮质间的信息流，发现PD中对皮质对STN的过度输入。所得结果支持将中央前回作为治疗的靶点，如重复经颅磁刺激。

动态因果建模（Dynamical causal modeling）

DCM框架能够有效刻画分布式神经响应之间的有效连接网络。DCM框架能够有效地实现多模态融合：由于其所使用的MRI生成模型可同时产生血流动力学响应以及电磁响应，因此可以使用这两种方式来估计同一模型的参数{friston2019}。动态因果模型框架的另一优势是不要求EEG和fMRI数据必须同步采集。换句话说，我们可以首先利用事件相关或诱导反应来分析脑电数据，以估计DCM的连接和突触参数。这些后验估计然后成为先验概率分布，用于随后的反演，使用fMRI数据来估计区域特异性的血流动力学参数。这被称为贝叶斯信念更新，并恰当地解释了神经元和血流动力学参数之间的条件依赖性。由此产生的多模态贝叶斯融合提供了功能解剖学的全面特征，利用了不同成像模式的时间(电磁)和空间(fMRI)特性。动态因果模型已经解答了部分生理学问题，这些问题涉及皮质层次的前向和后向连接的作用，以及突触层面的实验效应是如何介导的{bastos2015}。

DCM框架已被大量用于错配负性（mismatch negativity）的研究，确定了一个由五个皮层源组成的分层网络，以解释由标准和异常刺激引起的诱发反应{kiebel2008}。

在模型驱动的对称EEG-fMRI融合分析方法中，EEG和fMRI被集成在一个共同的概率框架中，通过基于共享神经基质的生物物理生成过程，明确地转化为EEG和fMRI观察结果。虽然该建模方法具有强大的解释能力，但也存在一些挑战，包括脑电图和功能磁共振正演模型的选择，脑电图、功能磁共振和神经元反应之间的时空维度不匹配，以及有效的模型反演的困难。目前的工作重点是发展神经-血管耦合的生物物理模型的理论框架{philiastides2021}。

研究内容：基于对称的EEG-fMRI模型驱动数据融合方法，和电生理以及血流动力学正演神经集群模型，建立皮层下深部核团层流特异性反应的动态因果模型，每个区域由标准的四区域神经集群模型表示{friston2019}。根据血流动力学和电生理的经验测量结果，反演神经活动的有效连接。首先，利用事件相关反应分析EEG数据，估计动态因果模型的连接和突触参数，作为贝叶斯推断的先验概率分布，随后，使用fMRI数据来估计区域特异性的血流动力学参数，由多模态贝叶斯融合模型推断有效连接参数值。对所得的有效连接网络进行生理学问题研究，分析深部核团内部，以及核团与周围组织的特异性连接关系，基于模型解释如何在突触水平上调节实验效应。

**研究内容一：信号特征提取解析深部核团功能分区**

针对目前单一测量模态信号时间或空间分辨率不足，单一模态信号分析难以揭示大脑皮层下深部核团，即丘脑底核不同亚群的功能特异性问题，本课题拟利用EEG和fMRI数据，提出可区分深部核团功能特性的多模态定量特征提取方法，并将所提出的核团功能特异性特征作为目标，构建动态因果模型用于反演信号特征背后的神经基质，以解析深部核团的功能分区。

首先，通过单变量/多变量/图网络的方法提取EEG特征以及fMRI特征，评估几种定量测度或特征检测深部核团不同亚群的能力，并集成多个度量，以获得跨度量的潜在独立信息。从众筛选出最优特征组合，作为丘脑底核不同亚群特异性功能表征。

进一步将所得的最优信号特征测度作为目标，反演所提取信号特征背后的神经基质。采用动态因果模型框架对信号特征进行反演，模型框架内同时包括血流动力学响应以及电磁响应的MRI生成模型，因此可以使用这两种方式来估计同一模型的参数。首先，将EEG信号特征作为动态因果模型的目标，估计动态因果模型的连接和突触参数，作为贝叶斯推断的先验概率分布，随后，使用fMRI特征来估计区域特异性的血流动力学参数，由多模态贝叶斯融合模型推断网络的有效连接，所得的有效连接网络代表了深部核团内部和及其与周围区域执行相应功能的神经基质。对该网络进行生理学问题研究，分析深部核团内部，以及核团与周围组织的特异性有效连接关系，基于模型解释如何在突触水平上理解深部核团的功能分区特性。所得结果将为后续建模工作提供结构基础。





#### bottcher2022：AI解决复杂高维网络系统控制问题

内容概要：提出AI Pontryagin框架，用于解决复杂高维系统（neural ODEs）时变控制信号求解问题，并且通过线性系统解析+非线性系统数值模拟的方式，说明ANN学习出的控制信号，与传统最优控制方法得出的信号具有相似的控制能量和系统达到的最终状态（应该是本文主要贡献），文中给出了AI Pontryagin控制耦合Kuramoto系统的数值实验例子。

作者指出，AI Pontryagin较传统方法（adjoint-system-based control methods）的优势在于：1）无需求解共轭系统，仅需已知系统动力学、初态和目标状态；2）运行速度快于传统共轭梯度法。

数值实验部分，文章里利用该神经网络实现了Kuramoto系统（N=1024）从非同步态到完全同步以及指定相位（±π/4）的控制。

作为拓展阅读，学习了控制理论、人工神经网络的一些基本概念和常用方法。本文提出的ANN求解复杂系统控制问题仅需已知系统动力学、初态和目标状态。虽然本文与我们目前的研究内容暂无关联，但文中以Kuramoto系统的最优控制为例，与模拟脑网络的高维复杂动力学系统形式上类似，具有技术上的潜在参考价值，作者也公开了代码可供学习。如果放在脑网络系统背景下，系统动力学和初态往往已知，所以对目标状态的描述是关键，即有意义的脑动力学状态描述。这也就是目前脑网络动力学研究关注的问题。